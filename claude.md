# CODEX 开发标准

## 项目概述

CODEX是本项目的AI开发助手，专门用于处理复杂的实现任务、代码优化和问题解决。

## 开发标准

### 1. CODEX 使用原则

**何时调用 CODEX：**
- 遇到复杂的实现任务时
- 需要修复多个编译错误或警告时
- 进行架构重构或代码优化时
- 实现缺失的功能模块时
- 遇到技术难题需要深度分析时

**调用 CODEX 的时机：**
1. **产生 TODO 后立即调用**：当创建新的 TODO 项目，特别是复杂任务时
2. **编译错误超过5个时**：批量修复编译问题
3. **实现新功能模块时**：如认证、压缩、同步等核心功能
4. **代码审查和优化时**：提升代码质量和性能

### 2. 开发工作流

```
发现问题 → 创建 TODO → 评估复杂度 → [复杂] 调用 CODEX → [简单] 直接实现 → 验证结果
```

**具体步骤：**
1. 识别需要实现或修复的功能
2. 使用 TodoWrite 工具创建相应的任务
3. 评估任务复杂度：
   - 简单任务（1-2步）：直接实现
   - 复杂任务（3+步或需要深度分析）：调用 CODEX
4. 执行任务
5. 验证结果并标记 TODO 为完成

### 3. CODEX 专用指令

使用以下格式调用 CODEX：
```
请使用 CODEX 来处理以下任务：
- [具体任务描述1]
- [具体任务描述2]
- ...

当前上下文：
- 项目类型：Rust CLI 工具
- 主要功能：进程树管理和配置同步
- 已实现模块：OAuth认证、配置文件统一、压缩抽象层
- 当前问题：[具体问题描述]
```

### 4. 项目特定指导

**已实现的标准：**
- OAuth 2.0 认证使用 auth.json 存储，不使用环境变量
- 配置文件统一为 sync.json 格式，包含 config 和 state 两部分
- 跨平台压缩抽象层，支持 TAR.GZ、ZIP、7Z 格式
- 删除了未使用的时间戳调度器功能

**代码质量要求：**
- 使用 `#[deny(unused_imports)]` 等严格 lint 规则
- 异步函数使用 `?` 运算符进行错误传播
- 实现完整的错误处理和日志记录
- 编写单元测试和集成测试

### 5. 示例场景

**场景1：修复编译错误**
```
出现15个编译警告 → 创建 TODO → 调用 CODEX 批量修复
```

**场景2：实现新功能**
```
需要实现7Z压缩器 → 创建 TODO → 评估为跨平台工具调用 → 调用 CODEX 实现
```

**场景3：架构优化**
```
发现代码重复 → 创建 TODO → 评估为重构任务 → 调用 CODEX 优化架构
```

### 6. 记住的原则

1. **主动使用 CODEX**：不要等到问题积累严重时才调用
2. **复杂任务优先**：CODEX 擅长处理复杂的多步骤任务
3. **提供充分上下文**：调用时说明项目状态和具体需求
4. **验证结果**：CODEX 完成后要验证代码质量和功能正确性

---

*此标准根据项目需求持续更新，确保 CODEX 的有效使用和项目的高质量开发。*